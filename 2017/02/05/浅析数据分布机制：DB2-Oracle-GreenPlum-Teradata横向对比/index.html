<!DOCTYPE html>
<html>
    <head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Title -->
    
    <title>
        浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比 | instore.top | Learn More, Share More.
    </title>
    
    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.ico">
    <link rel="icon" sizes="192x192" href="/img/favicon.ico">
    <link rel="apple-touch-icon" href="/img/favicon.ico">
    
    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Liang3p">
    <meta name="description" content="Learn More, Share More.--We are not exactly sure what is in store for us, but we know that sharing ideas keeps us moving on. I wish everyone have the big surprise InStore.">
    <meta name="keywords" content="null">
    
    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="instore.top | Learn More, Share More.">
    
    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://instore.top">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比 | instore.top | Learn More, Share More.">
    <meta property="og:description" content="Learn More, Share More.--We are not exactly sure what is in store for us, but we know that sharing ideas keeps us moving on. I wish everyone have the big surprise InStore.">
    
     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">
        
        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->
    
    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #00838F
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #0097A7 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #0097A7 !important
    }
    
    .toTop{
        background: #757575 !important
    }
		
	.material-layout .material-post>.material-nav,
	.material-layout .material-index>.material-nav,
	.material-nav a{
		color: #757575;
	}
		
	#scheme-Paradox .MD-burger-layer {
		background-color: #757575;
	}

	#scheme-Paradox #post-toc-trigger-btn{
		color: #757575;
	}
	
	.post-toc a:hover{
		color: #00838F;
		text-decoration: underline;
	}
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5
        }
		
		/* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>

	<script src="/js/jquery.min.js"></script>
	
	<link rel="stylesheet" href="/css/highlight/solarized-white.css">
	
	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>
    
    <!-- Custom Head --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
</head>
	
	

    <body id="scheme-Paradox">

		
        <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                <!-- Post TOC -->

    
	<!-- Back Button -->
<!--
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			
-->
	<!-- Left aligned menu below button -->
	<button id="post-toc-trigger-btn"
			class="mdl-button mdl-js-button mdl-button--icon">
	  <i class="material-icons">format_list_numbered</i>
	</button>

	<ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
		for="post-toc-trigger-btn">
			
			<ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#分布的概念和特点"><span class="post-toc-number">1.</span> <span class="post-toc-text">分布的概念和特点</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#数据分布的目的"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">数据分布的目的</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#分区的概念"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">分区的概念</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#分区的特点"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">分区的特点</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#数据分布的方式"><span class="post-toc-number">2.</span> <span class="post-toc-text">数据分布的方式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Range分区"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">Range分区</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hash分区"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">Hash分区</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#List分区"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">List分区</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Range-List"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">Range-List</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Range-Hash分区"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">Range-Hash分区</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#各种分布方式的适用场景"><span class="post-toc-number">3.</span> <span class="post-toc-text">各种分布方式的适用场景</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#几种流行的数据仓库参数横向对比及分区实例"><span class="post-toc-number">4.</span> <span class="post-toc-text">几种流行的数据仓库参数横向对比及分区实例</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#总结"><span class="post-toc-number">5.</span> <span class="post-toc-text">总结</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">6.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
		
<!--			<li class="mdl-menu__item">Some Action</li>-->
	</ul>



<!-- Layouts -->


<!-- header_home -->

<!-- header_home -->
<div class="material-index mdl-grid" style="margin-top: -145px;padding-left: 10px;padding-bottom: 80px;">
    <a href="/">
        <img src="/img/instore.top.png" alt="logo" />
    </a>
</div>


    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		
			<!-- Random Thumbnail -->
			<div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
				<script>
    
    var randomNum;
    randomNum = Math.floor(Math.random() * 5 + 1);
    
    $(".post_thumbnail-random").css('background-image', 'url(' + '/img/random/' + randomNum + '.png' + ')');
    
</script>

		
	
        <p class="article-headline-p">
            浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比
        </p>
    </div>

	


				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
    
    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Liang3p</strong>
        <span>2月 05, 2017</span>
    </div>
    
    <div class="section-spacer"></div>
	
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->
    
    <!-- Tags (bookmark) -->
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/分区/">分区</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/数据分布/">数据分布</a>
    </ul>
    
    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    
    
    
    
    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比&url=http://instore.top//2017/02/05/浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比/index.html&via=Liang3p" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>
    
    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://instore.top//2017/02/05/浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>
    
    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比&url=http://instore.top//2017/02/05/浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>
</ul>
</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<p>设计建设数据仓库之初,查询性能是一项非常重要的性能指标.影响查询性能的因素很多,数据分布是数据查询性能优化的重点之一。数据分布是并行数据库系统实现的基础,MPP架构的数据仓库更是依赖于其数据库内部强大的数据分布机制.本文介绍了几种传统关系型数据库的数据分布特点,并对其适用场景做了简要介绍.<br>At the beginning of the data warehouse design construction, query performance is a very important performance indicator. There are many factors which can affect the query performance, data distribution is one of the focus of the data query performance optimization. Data distribution is the basis of parallel database system, the MPP architecture of data warehouse is dependent on its powerful data distribution inside the database system. This paper introduces several kinds of traditional relational database data distribution characteristics, and has made the brief introduction of the applicable to the scene.</p>
<h2 id="分布的概念和特点"><a href="#分布的概念和特点" class="headerlink" title="分布的概念和特点"></a>分布的概念和特点</h2><p>了解数据库的数据分布机制对于提升系统性能有很大帮助。以Teradata为例，主索引(Primary Index)的设置就能影响数据分布。在Teradata中，除了Partition进行数据分区外，PI字段会按照Hash散列算法对数据进行分布，因此在建表的时候需要慎重选择PI，以免因PI字段重复值过多而造成表倾斜。实际应用时，在Teradata中建立一张PPI表可以显著提升历史数据处理的速度，这点对于查询任务繁重的数据仓库系统非常重要。</p>
<h3 id="数据分布的目的"><a href="#数据分布的目的" class="headerlink" title="数据分布的目的"></a>数据分布的目的</h3><p>在数据库设计中,通过数据切分实现数据的快速检索.数据分区与索引优化不同,索引是将索引字段按照Hash算法进行拆分存储,在查询时,就可以根据索引从而快速定位到物理存储节点上，从而加快查询速度.大部分MPP架构的数据库都支持Hash分布, 这使得索引可以很好的提升查询性能，并且不会造成数据倾斜.<br>MySQL数据库作为当下最流行的开源免费的数据库,一般应用于中小型企业的业务系统的搭建.尽管其非MPP架构、子查询优化不佳、对复杂查询优化不够、不支持Hash join和Merge- join等致命缺陷,但是仍有不少的企业将其做为小型数据集市的选择(从性能方面考虑,MySQL更适合应用在业务系统的建设中,而不是用来作为数据仓库的基础配置).可能是因为这些明显的短板,MySQL的性能优化更多的集中在了分库、分表、读写分离的方式上.当数据量级上升,业务复杂度增加时,MySQL很容易遭遇性能问题.因此,企业一般都需要对业务做水平或者垂直的拆分,再进行分库分表操作.出于集群整体的读写性能考虑,一般都会进行主从复制,读写分离的架构,这点对于OLTP设计的MySQL主数据存储尤为重要.但是，如此操作也会有相应的代价：拆分对线上业务造成冲击，多表关联和事务性要求高的场合不适用;垂直拆分时,需要配置多个数据源,造成业务单元内部零散化,业务模块间数据处理相对混乱,耦合难度上升,这也会提高数据库的管理成本.</p>
<h3 id="分区的概念"><a href="#分区的概念" class="headerlink" title="分区的概念"></a>分区的概念</h3><p>对于数据仓库系统大量的OLAP操作,分库、分表、索引等数据拆分的手段在大量的历史数据和增量数据面前表现相对无力。<strong>分区(PATITION)</strong>就是表内实现数据分片操作的重要手段.一般而言,数据分片在历史数据场景中更多是对于时间区间内的数据处理(比如常规按照日期频度汇总、差分、累计平均等操作的报表、指标和时间序列数据的预测等).这些操作经常需要获取一段时间的数据,使用时间字段作为分区就能快速得到相应的数据分片.<br>一般而言，在以下条件时通常会创建一个分区表来改善性能:</p>
<ul>
<li>单表数据量巨大</li>
<li>表中包含历史数据,新的数据将被增量更新到历史表中</li>
</ul>
<h3 id="分区的特点"><a href="#分区的特点" class="headerlink" title="分区的特点"></a>分区的特点</h3><p>使用分区表的优点：</p>
<ul>
<li>改善查询性能：对分区对象的查询可以仅搜索自己需要的分区,提高检索速度</li>
<li>增强可用性：如果表的某个分区出现故障,表在其他分区的数据仍然可用</li>
<li>维护方便：如果表的某个分区出现故障,需要修复数据,只修复该分区即可</li>
<li>均衡I/O：可以把不同的分区映射到不同磁盘以平衡I/O,改善整个系统性能</li>
</ul>
<h2 id="数据分布的方式"><a href="#数据分布的方式" class="headerlink" title="数据分布的方式"></a>数据分布的方式</h2><p>以Oracle为例，支持以下几种分区方式：</p>
<ul>
<li>Range分区</li>
<li>Hash分区</li>
<li>List分区</li>
<li>以及组合分区：Range-Hash,Range-List</li>
</ul>
<h3 id="Range分区"><a href="#Range分区" class="headerlink" title="Range分区"></a>Range分区</h3><p><strong>Range分区</strong>是用数值区间作为分区依据的一种分区方法.选取这种分区方式首先会将分区字段划分若干个数值区间,每一个数值区间是一个分区.<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> T_PARTITION_RANGE</div><div class="line">(</div><div class="line">    <span class="keyword">ID</span> <span class="built_in">NUMBER</span>,</div><div class="line">    <span class="keyword">NAME</span> VARCHAR2(<span class="number">50</span>)</div><div class="line">)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(<span class="keyword">ID</span>)</div><div class="line">(</div><div class="line">    <span class="keyword">PARTITION</span> T_RANGE_P1 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">10</span>) <span class="keyword">TABLESPACE</span> TBSPART01,</div><div class="line">    <span class="keyword">PARTITION</span> T_RANGE_P2 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">20</span>) <span class="keyword">TABLESPACE</span> TBSPART02,</div><div class="line">    <span class="keyword">PARTITION</span> T_RANGE_P3 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">30</span>) <span class="keyword">TABLESPACE</span> TBSPART03,</div><div class="line">    <span class="keyword">PARTITION</span> T_RANGE_PMAX <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (MAXVALUE) <span class="keyword">TABLESPACE</span> TBSPART04</div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">--创建一个自动按照时间分区的表</span></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> T_PARTITION_RANGE_AUTO</div><div class="line">(</div><div class="line">    DATE_TAG <span class="built_in">DATE</span>,</div><div class="line">    ACC_NBR VARCHAR2(<span class="number">20</span>),</div><div class="line">    <span class="keyword">CATEGORY</span> VARCHAR2(<span class="number">200</span>)</div><div class="line">)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(DATE_TAG)</div><div class="line"><span class="built_in">INTERVAL</span> (numtodsinterval(<span class="number">1</span>,<span class="string">'DAY'</span>))</div><div class="line">(</div><div class="line"><span class="keyword">PARTITION</span> T_RANGE_P1 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="keyword">TO_DATE</span>(<span class="string">'20170101'</span>,<span class="string">'YYYYMMDD'</span>))</div><div class="line">);</div></pre></td></tr></table></figure></p>
<h3 id="Hash分区"><a href="#Hash分区" class="headerlink" title="Hash分区"></a>Hash分区</h3><p><strong>Hash分区</strong>对分区字段的哈希算法将数据映射到分区中的分区的方法。当数据不太容易进行范围划分时，为了性能和管理的原因又想分区时，就可以使用散列分区方法。Hash分区将在指定数量的分区中均等得划分数据。创建散列分区需要指定分区列、分区数量(或单独的分区描述)。举例如下：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> T_PARTITION_HASH(</div><div class="line">    <span class="keyword">ID</span> VARCHAR2(<span class="number">32</span>),</div><div class="line">    <span class="keyword">NAME</span> VARCHAR2(<span class="number">50</span>)</div><div class="line">)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">HASH</span>(<span class="keyword">ID</span>)</div><div class="line">(</div><div class="line">     <span class="keyword">PARTITION</span> PART_01,</div><div class="line">     <span class="keyword">PARTITION</span> PART_02,</div><div class="line">     <span class="keyword">PARTITION</span> PART_03,</div><div class="line">     <span class="keyword">PARTITION</span> PART_04,</div><div class="line">     <span class="keyword">PARTITION</span> PART_05,</div><div class="line">     <span class="keyword">PARTITION</span> PART_06,</div><div class="line">     <span class="keyword">PARTITION</span> PART_07,</div><div class="line">     <span class="keyword">PARTITION</span> PART_08</div><div class="line">)</div><div class="line"><span class="keyword">TABLESPACE</span> DDS_DATA</div><div class="line">PCTFREE  <span class="number">10</span></div><div class="line"><span class="keyword">INITRANS</span> <span class="number">2</span></div><div class="line"><span class="keyword">MAXTRANS</span> <span class="number">255</span></div><div class="line"><span class="keyword">STORAGE</span></div><div class="line">(</div><div class="line">    <span class="keyword">INITIAL</span> <span class="number">64</span>K</div><div class="line">    <span class="keyword">NEXT</span>    <span class="number">64</span>K</div><div class="line">    <span class="keyword">MINEXTENTS</span> <span class="number">1</span></div><div class="line">    <span class="keyword">MAXEXTENTS</span> <span class="keyword">UNLIMITED</span></div><div class="line">);</div></pre></td></tr></table></figure></p>
<h3 id="List分区"><a href="#List分区" class="headerlink" title="List分区"></a>List分区</h3><p><strong>List分区</strong>是根据字段具体数值进行分区的方法。与Range分区不同的是，它是针对具体数值而不是数据区间进行分区的，因此，这就要求分区字段的值少数且有限的集合。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> T_LIST_PARTITION</div><div class="line">(</div><div class="line">MKT_LOC VARCHAR2(<span class="number">20</span>),</div><div class="line">SALES_AMT <span class="built_in">NUMBER</span></div><div class="line">)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">LIST</span>(MKT_LOC)</div><div class="line">(</div><div class="line"><span class="keyword">PARTITION</span> P1 <span class="keyword">VALUES</span> (<span class="string">'BJ'</span>,<span class="string">'SH'</span>,<span class="string">'GZ'</span>,<span class="string">'SZ'</span>),</div><div class="line"><span class="keyword">PARTITION</span> P2 <span class="keyword">VALUES</span> (<span class="string">'TJ'</span>,<span class="string">'NJ'</span>,<span class="string">'WH'</span>,<span class="string">'SY'</span>,<span class="string">'XA'</span>,<span class="string">'CD'</span>,<span class="string">'CQ'</span>,<span class="string">'HZ'</span>,<span class="string">'DL'</span>,<span class="string">'QD'</span>,<span class="string">'NB'</span>,<span class="string">'SZ'</span>,<span class="string">'WX'</span>),</div><div class="line"><span class="keyword">PARTITION</span> P3 <span class="keyword">VALUES</span> (<span class="keyword">DEFAULT</span>)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<h3 id="Range-List"><a href="#Range-List" class="headerlink" title="Range-List"></a>Range-List</h3><p><strong>Range-List</strong>分区基于范围分区和列表分区，表首先按某列进行范围分区，然后再按某列进行列表分区，分区之中的分区被称为子分区。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SALES</div><div class="line">(</div><div class="line">	PRODUCT_ID VARCHAR2(<span class="number">5</span>),</div><div class="line">	SALES_DATE <span class="built_in">DATE</span>,</div><div class="line">	SALES_COST <span class="built_in">NUMBER</span>(<span class="number">10</span>),</div><div class="line">	<span class="keyword">STATUS</span> VARCHAR2(<span class="number">20</span>)</div><div class="line">)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(SALES_DATE)</div><div class="line">	<span class="keyword">SUBPARTITION</span> <span class="keyword">BY</span> <span class="keyword">LIST</span> (<span class="keyword">STATUS</span>)</div><div class="line">	(</div><div class="line">		<span class="keyword">PARTITION</span> P1 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="keyword">TO_DATE</span>(<span class="string">'2016-01-01'</span>,<span class="string">'YYYY-MM-DD'</span>)) <span class="keyword">TABLESPACE</span> P1_TS</div><div class="line">		(</div><div class="line">			<span class="keyword">SUBPARTITION</span> P1SUB1 <span class="keyword">VALUES</span> (<span class="string">'ACTIVE'</span>) <span class="keyword">TABLESPACE</span> SUBP1_TS1,</div><div class="line">			<span class="keyword">SUBPARTITION</span> P1SUB2 <span class="keyword">VALUES</span> (<span class="string">'INACTIVE'</span>) <span class="keyword">TABLESPACE</span> SUBP1_TS2</div><div class="line">		),</div><div class="line">		<span class="keyword">PARTITION</span> P2 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="keyword">TO_DATE</span>(<span class="string">'2016-12-31'</span>,<span class="string">'YYYY-MM-DD'</span>)) <span class="keyword">TABLESPACE</span> P2_TS</div><div class="line">		(</div><div class="line">			<span class="keyword">SUBPARTITION</span> P2SUB1 <span class="keyword">VALUES</span> (<span class="string">'ACTIVE'</span>) <span class="keyword">TABLESPACE</span> SUBP2_TS1,</div><div class="line">			<span class="keyword">SUBPARTITION</span> P2SUB2 <span class="keyword">VALUES</span> (<span class="string">'INACTIVE'</span>) <span class="keyword">TABLESPACE</span> SUBP2_TS2</div><div class="line">		)</div><div class="line">		<span class="keyword">PARTITION</span> P3 <span class="keyword">LESS</span> <span class="keyword">THAN</span> (MAXVALUE) <span class="keyword">TABLESPACE</span> P3_TS</div><div class="line">		(</div><div class="line">			<span class="keyword">SUBPARTITION</span> P3SUB1 <span class="keyword">VALUES</span> (<span class="string">'ACTIVE'</span>) <span class="keyword">TABLESPACE</span> SUBP3_TS1,</div><div class="line">			<span class="keyword">SUBPARTITION</span> P3SUB2 <span class="keyword">VALUES</span> (<span class="string">'INACTIVE'</span>) <span class="keyword">TABLESPACE</span> SUBP3_TS2</div><div class="line">		)</div><div class="line">	)</div><div class="line">;</div></pre></td></tr></table></figure></p>
<h3 id="Range-Hash分区"><a href="#Range-Hash分区" class="headerlink" title="Range-Hash分区"></a>Range-Hash分区</h3><p><strong>Range-Hash分区</strong>是基于范围分区和散列分区，表首先按某列进行范围分区，然后再按某列进行散列分区。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> T_PARTITION_RH</div><div class="line">(</div><div class="line"><span class="keyword">ID</span> <span class="built_in">NUMBER</span>,</div><div class="line"><span class="keyword">NAME</span> VARCHAR2(<span class="number">50</span>)</div><div class="line">)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(<span class="keyword">ID</span>)</div><div class="line">	<span class="keyword">SUBPARTITION</span> <span class="keyword">BY</span> <span class="keyword">HASH</span>(<span class="keyword">NAME</span>)</div><div class="line">	<span class="keyword">SUBPARTITION</span> <span class="keyword">TEMPLATE</span></div><div class="line">	(</div><div class="line">		<span class="keyword">SUBPARTITION</span> H1 <span class="keyword">TABLESPACE</span> TBSPART01,</div><div class="line">		<span class="keyword">SUBPARTITION</span> H2 <span class="keyword">TABLESPACE</span> TBSPART02,</div><div class="line">		<span class="keyword">SUBPARTITION</span> H3 <span class="keyword">TABLESPACE</span> TBSPART03,</div><div class="line">		<span class="keyword">SUBPARTITION</span> H4 <span class="keyword">TABLESPACE</span> TBSPART04</div><div class="line">	)</div><div class="line">(</div><div class="line"><span class="keyword">PARTITION</span> T_R_P1 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">10</span>) <span class="keyword">TABLESPACE</span> TBSPART01,</div><div class="line"><span class="keyword">PARTITION</span> T_R_P2 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">20</span>) <span class="keyword">TABLESPACE</span> TBSPART02,</div><div class="line"><span class="keyword">PARTITION</span> T_R_P3 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">30</span>) <span class="keyword">TABLESPACE</span> TBSPART03,</div><div class="line"><span class="keyword">PARTITION</span> T_R_PD <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (MAXVALUE) <span class="keyword">TABLESPACE</span> TBSPART04</div><div class="line">);</div></pre></td></tr></table></figure></p>
<h2 id="各种分布方式的适用场景"><a href="#各种分布方式的适用场景" class="headerlink" title="各种分布方式的适用场景"></a>各种分布方式的适用场景</h2><ol>
<li><p><strong>Range Partition</strong><br>当你需要存储大量历史数据时，Range Partition是一种方便的组织数据的方法。你可以通过对日期字段进行分区，其中每一个时间频度生成是一个分区，当有增量数据写入的时，新的分区会被自动创建。<br>在处理周期性的load新数据和purge老数据的时候，Range Partition也是一个理想的选择。<br>应用场景：</p>
<ul>
<li>有一个大表需要通过时间字段频繁的访问，通过这个时间字段做Range Partition有利于做分区裁剪。</li>
<li>如果你不能对一个大表在指定的时间内做备份或RESTORE,你可以通过RANGE把他们分成小的logic片来做。</li>
</ul>
</li>
<li><p><strong>Hash Partition</strong><br>当数据不太容易进行范围划分时，为了性能和管理的原因又想分区时，就可以使用散列分区方法。Hash Partition可以很好的均衡每个分区的数据量级，最大程度的减少表倾斜，但它不是一个很好的管理历史数据的方法。<br>应用场景：</p>
<ul>
<li>增加大表的可用性。</li>
<li>避免各个分区之间查找数据，并且各个分区可以放在不同的设备上，达到最大的I0吞吐量。也可以用STORE IN 子句分配每个分区到不同的表空间。</li>
</ul>
</li>
<li><p><strong>LIST Partition</strong><br>当分区数据是少量的有限集合但又不方便进行Range Partition时,要对于这些离散的值进行分区,LIST Partition是个比较好的选择。</p>
</li>
<li><p><strong>Composite Range-Hash Partitioning</strong><br>这是Range和Hash的组合使用，先对表用RANGE分，然后对每个RANGE再做HASH分区。<br>由于做了RANGE后的子分区是没有规律的，如果在数据仓库设计时候，通过查询需求觉得有必要再细分，可以考虑使用。</p>
</li>
</ol>
<h2 id="几种流行的数据仓库参数横向对比及分区实例"><a href="#几种流行的数据仓库参数横向对比及分区实例" class="headerlink" title="几种流行的数据仓库参数横向对比及分区实例"></a>几种流行的数据仓库参数横向对比及分区实例</h2><p>在此，我们先选取几种流行的数据仓库解决方案做一个静态参数上的对比。这些参数只是全部数据中的一小部分，但是它们对于构建数据仓库至关重要：</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>DB2</th>
<th>Greenplum</th>
<th>Oracle</th>
<th>Teradata</th>
</tr>
</thead>
<tbody>
<tr>
<td>Technical documentation</td>
<td><a href="https://www.ibm.com/-support/-entry/-portal/-support?brandind=information%20management" target="_blank" rel="external">https://www.ibm.com/-support/-entry/-portal/-support?brandind=information%20management</a></td>
<td><a href="http://docs.pivotal.io/-gpdb" target="_blank" rel="external">http://docs.pivotal.io/-gpdb</a></td>
<td><a href="http://docs.oracle.com/-en/-database/-database.html" target="_blank" rel="external">http://docs.oracle.com/-en/-database/-database.html</a></td>
<td><a href="http://www.info.teradata.com" target="_blank" rel="external">http://www.info.teradata.com</a></td>
</tr>
<tr>
<td>License</td>
<td>commercial</td>
<td>Open Source</td>
<td>commercial</td>
<td>commercial</td>
</tr>
<tr>
<td>Partitioning methods</td>
<td>Sharding</td>
<td>Sharding</td>
<td>horizontal partitioning</td>
<td>Sharding</td>
</tr>
<tr>
<td>Replication methods</td>
<td>yes</td>
<td>Master-slave replication</td>
<td>Master-master replication Master-master replication</td>
<td>Master-slave replication</td>
</tr>
<tr>
<td>MapReduce</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td>Server-side scripts</td>
<td>yes</td>
<td>yes</td>
<td>PL/SQL</td>
<td>yes</td>
</tr>
<tr>
<td>Triggers</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>Foreign keys</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>Transaction concepts</td>
<td>ACID</td>
<td>ACID</td>
<td>ACID</td>
<td>ACID</td>
</tr>
<tr>
<td>Data scheme</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>Typing</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>XML support</td>
<td></td>
<td>yes</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>Secondary indexes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p>更多参数对比请参考：<br><a href="http://db-engines.com/en/system/Oracle%3BTeradata%3BGreenPlum%3BDB2" target="_blank" rel="external">http://db-engines.com/en/system/Oracle%3BTeradata%3BGreenPlum%3BDB2</a></p>
<p>下面我们例举一些分区的实例。</p>
<p>GreenPlum中分区的实现：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="comment">--Range Partition</span></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> sales (<span class="keyword">id</span> <span class="built_in">int</span>, <span class="built_in">date</span> <span class="built_in">date</span>, amt <span class="built_in">decimal</span>(<span class="number">10</span>,<span class="number">2</span>))</div><div class="line"><span class="keyword">DISTRIBUTED</span> <span class="keyword">BY</span> (<span class="keyword">id</span>)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (<span class="built_in">date</span>)</div><div class="line">( <span class="keyword">PARTITION</span> Jan08 <span class="keyword">START</span> (<span class="built_in">date</span> <span class="string">'2008-01-01'</span>) INCLUSIVE ,</div><div class="line">  <span class="keyword">PARTITION</span> Feb08 <span class="keyword">START</span> (<span class="built_in">date</span> <span class="string">'2008-02-01'</span>) INCLUSIVE ,</div><div class="line">  <span class="keyword">PARTITION</span> Mar08 <span class="keyword">START</span> (<span class="built_in">date</span> <span class="string">'2008-03-01'</span>) INCLUSIVE ,</div><div class="line">  <span class="keyword">PARTITION</span> Apr08 <span class="keyword">START</span> (<span class="built_in">date</span> <span class="string">'2008-04-01'</span>) INCLUSIVE ,</div><div class="line">  <span class="keyword">PARTITION</span> May08 <span class="keyword">START</span> (<span class="built_in">date</span> <span class="string">'2008-05-01'</span>) INCLUSIVE ,</div><div class="line">  <span class="keyword">PARTITION</span> Jun08 <span class="keyword">START</span> (<span class="built_in">date</span> <span class="string">'2008-06-01'</span>) INCLUSIVE ,</div><div class="line">   <span class="keyword">END</span> (<span class="built_in">date</span> <span class="string">'2009-01-01'</span>) EXCLUSIVE );</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">rank</span> (<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">rank</span> <span class="built_in">int</span>, <span class="keyword">year</span> <span class="built_in">int</span>, gender <span class="built_in">char</span>(<span class="number">1</span>), <span class="keyword">count</span> <span class="built_in">int</span>)</div><div class="line"><span class="keyword">DISTRIBUTED</span> <span class="keyword">BY</span> (<span class="keyword">id</span>)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (<span class="keyword">year</span>)</div><div class="line">( <span class="keyword">START</span> (<span class="number">2001</span>) <span class="keyword">END</span> (<span class="number">2008</span>) EVERY (<span class="number">1</span>),</div><div class="line">  <span class="keyword">DEFAULT</span> <span class="keyword">PARTITION</span> extra );</div><div class="line"></div><div class="line"><span class="comment">--List Partition</span></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">rank</span> (<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">rank</span> <span class="built_in">int</span>, <span class="keyword">year</span> <span class="built_in">int</span>, gender <span class="built_in">char</span>(<span class="number">1</span>), <span class="keyword">count</span> <span class="built_in">int</span> )</div><div class="line"><span class="keyword">DISTRIBUTED</span> <span class="keyword">BY</span> (<span class="keyword">id</span>)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">LIST</span> (gender)</div><div class="line">(	<span class="keyword">PARTITION</span> girls <span class="keyword">VALUES</span> (<span class="string">'F'</span>),</div><div class="line">	<span class="keyword">PARTITION</span> boys <span class="keyword">VALUES</span> (<span class="string">'M'</span>),</div><div class="line">	<span class="keyword">DEFAULT</span> <span class="keyword">PARTITION</span> other );</div><div class="line"></div><div class="line"><span class="comment">-- multi-level partitions</span></div><div class="line"></div><div class="line"><span class="comment">--每个分区下，都会按照subpartition做分区。</span></div><div class="line"><span class="comment">--两层分区：</span></div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> sales (trans_id <span class="built_in">int</span>, <span class="built_in">date</span> <span class="built_in">date</span>, amount <span class="built_in">decimal</span>(<span class="number">9</span>,<span class="number">2</span>), region <span class="built_in">text</span>)</div><div class="line"><span class="keyword">DISTRIBUTED</span> <span class="keyword">BY</span> (trans_id)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (<span class="built_in">date</span>)</div><div class="line"><span class="keyword">SUBPARTITION</span> <span class="keyword">BY</span> <span class="keyword">LIST</span> (region)</div><div class="line"><span class="keyword">SUBPARTITION</span> <span class="keyword">TEMPLATE</span></div><div class="line">(	<span class="keyword">SUBPARTITION</span> usa <span class="keyword">VALUES</span> (<span class="string">'usa'</span>),</div><div class="line">	<span class="keyword">SUBPARTITION</span> asia <span class="keyword">VALUES</span> (<span class="string">'asia'</span>),</div><div class="line">	<span class="keyword">SUBPARTITION</span> europe <span class="keyword">VALUES</span> (<span class="string">'europe'</span>),</div><div class="line">	<span class="keyword">DEFAULT</span> <span class="keyword">SUBPARTITION</span> other_regions)</div><div class="line">	(<span class="keyword">START</span> (<span class="built_in">date</span> <span class="string">'2011-01-01'</span>) INCLUSIVE</div><div class="line">	<span class="keyword">END</span> (<span class="built_in">date</span> <span class="string">'2012-01-01'</span>) EXCLUSIVE</div><div class="line">	EVERY (<span class="built_in">INTERVAL</span> <span class="string">'1 month'</span>),</div><div class="line">	<span class="keyword">DEFAULT</span> <span class="keyword">PARTITION</span> outlying_dates );</div><div class="line"></div><div class="line"><span class="comment">--三层分区：</span></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> p3_sales (<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">year</span> <span class="built_in">int</span>, <span class="keyword">month</span> <span class="built_in">int</span>, <span class="keyword">day</span> <span class="built_in">int</span>, region <span class="built_in">text</span>)</div><div class="line"><span class="keyword">DISTRIBUTED</span> <span class="keyword">BY</span> (<span class="keyword">id</span>)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (<span class="keyword">year</span>)</div><div class="line">    <span class="keyword">SUBPARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (<span class="keyword">month</span>)</div><div class="line">       <span class="keyword">SUBPARTITION</span> <span class="keyword">TEMPLATE</span> (</div><div class="line">        <span class="keyword">START</span> (<span class="number">1</span>) <span class="keyword">END</span> (<span class="number">13</span>) EVERY (<span class="number">1</span>),</div><div class="line">        <span class="keyword">DEFAULT</span> <span class="keyword">SUBPARTITION</span> other_months )</div><div class="line">           <span class="keyword">SUBPARTITION</span> <span class="keyword">BY</span> <span class="keyword">LIST</span> (region)</div><div class="line">             <span class="keyword">SUBPARTITION</span> <span class="keyword">TEMPLATE</span> (</div><div class="line">               <span class="keyword">SUBPARTITION</span> usa <span class="keyword">VALUES</span> (<span class="string">'usa'</span>),</div><div class="line">               <span class="keyword">SUBPARTITION</span> europe <span class="keyword">VALUES</span> (<span class="string">'europe'</span>),</div><div class="line">               <span class="keyword">SUBPARTITION</span> asia <span class="keyword">VALUES</span> (<span class="string">'asia'</span>),</div><div class="line">               <span class="keyword">DEFAULT</span> <span class="keyword">SUBPARTITION</span> other_regions )</div><div class="line">( <span class="keyword">START</span> (<span class="number">2002</span>) <span class="keyword">END</span> (<span class="number">2012</span>) EVERY (<span class="number">1</span>),</div><div class="line">  <span class="keyword">DEFAULT</span> <span class="keyword">PARTITION</span> outlying_years );</div></pre></td></tr></table></figure></p>
<p>Teradata分区表建标<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">MULTISET</span> <span class="keyword">TABLE</span> NMART.RPT_MHV_NEW_BIND_ALARM_MON ,<span class="keyword">NO</span> FALLBACK ,</div><div class="line">     <span class="keyword">NO</span> <span class="keyword">BEFORE</span> JOURNAL,</div><div class="line">     <span class="keyword">NO</span> <span class="keyword">AFTER</span> JOURNAL,</div><div class="line">     <span class="keyword">CHECKSUM</span> = <span class="keyword">DEFAULT</span></div><div class="line">     (</div><div class="line">      CAL_Month <span class="built_in">INTEGER</span> TITLE <span class="string">'统计月份'</span>,</div><div class="line">      City_ID <span class="built_in">CHAR</span>(<span class="number">4</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> LATIN <span class="keyword">NOT</span> CASESPECIFIC TITLE <span class="string">'地市标识'</span>,</div><div class="line">      BUSN_DEPT_ID <span class="built_in">CHAR</span>(<span class="number">8</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> LATIN <span class="keyword">NOT</span> CASESPECIFIC TITLE <span class="string">'营业部标识'</span>,</div><div class="line">      MHV_FLG <span class="built_in">CHAR</span>(<span class="number">2</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> LATIN <span class="keyword">NOT</span> CASESPECIFIC TITLE <span class="string">'用户类型'</span>,</div><div class="line">      QTY <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'用户数'</span>,</div><div class="line">      NEW_CON_QTY <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'新增签约用户数'</span>,</div><div class="line">      NO_CON_LST_QTY <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'上月无签约捆绑用户数'</span>,</div><div class="line">      DUE_CON_LST_QTY <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'上月无签约捆绑到期用户数'</span>,</div><div class="line">      QTY1 <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'消费100-150元用户数'</span>,</div><div class="line">      QTY2 <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'消费150-250元用户数'</span>,</div><div class="line">      QTY3 <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'消费250元以上用户数'</span>,</div><div class="line">      NORMAL_QTY <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'普通用户数'</span>,</div><div class="line">      VIP_QTY <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'持卡用户数'</span>,</div><div class="line">      INNET1 <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'在网3个月以内用户数'</span>,</div><div class="line">      INNET2 <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'在网3到6个月用户数'</span>,</div><div class="line">      INNET3 <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'在网6到12个月用户数'</span>,</div><div class="line">      INNET4 <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'在网12到24个月用户数'</span>,</div><div class="line">      INNET5 <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'在网24个月以上用户数'</span>,</div><div class="line">      NEW_CON_W_QTY <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'新增高预警签约捆绑用户数'</span>,</div><div class="line">      NO_CON_LST_W_QTY <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'上月无签约捆绑高预警用户数'</span>,</div><div class="line">      DUE_CON_LST_W_QTY <span class="built_in">DECIMAL</span>(<span class="number">18</span>,<span class="number">0</span>) TITLE <span class="string">'上月签约到期高预警用户数'</span></div><div class="line">      )</div><div class="line">PRIMARY <span class="keyword">INDEX</span> ( City_ID ,BUSN_DEPT_ID )</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> RANGE_N(CAL_Month  <span class="keyword">BETWEEN</span> <span class="number">199001</span>  <span class="keyword">AND</span> <span class="number">201912</span>  <span class="keyword">EACH</span> <span class="number">1</span> ,</div><div class="line"> <span class="keyword">NO</span> <span class="keyword">RANGE</span> <span class="keyword">OR</span> <span class="keyword">UNKNOWN</span>);</div></pre></td></tr></table></figure></p>
<p>DB2分区表<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TEST.SALES</div><div class="line">( <span class="keyword">ID</span>                 <span class="built_in">INTEGER</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">  SALES_PERSON       <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</div><div class="line">  REGION             <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</div><div class="line">  SALES_DATE         <span class="built_in">DATE</span>)</div><div class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(SALES_DATE)</div><div class="line">( <span class="keyword">STARTING</span> <span class="keyword">MINVALUE</span>,</div><div class="line">  <span class="keyword">STARTING</span> <span class="string">'1/1/2012'</span> ENDING <span class="string">'12/31/2012'</span></div><div class="line">  EVERY <span class="number">1</span> <span class="keyword">MONTH</span>,</div><div class="line"> ENDING MAXVALUE);</div></pre></td></tr></table></figure></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>数据分布对于构建企业级数据仓库至关重要。使用分区表可以方便管理大量历史数据，灵活管理数据，减少IO消耗，增强了查询性能。对于不同的应用实例，需要根据情形选择分区方案，从而达到理想的性能和运维成本的均衡。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><blockquote>
<p>GreenPlum初窥: <a href="http://blog.csdn.net/micklf/article/details/51423055" target="_blank" rel="external">http://blog.csdn.net/micklf/article/details/51423055</a><br>3.2.1 创建基本表分区: <a href="http://book.2cto.com/201307/27938.html" target="_blank" rel="external">http://book.2cto.com/201307/27938.html</a></p>
</blockquote>

	
	
	
	
</div>

				

                <!-- Post Comments -->
                
                    
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #0097A7 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #0097A7 !important;
    }
    #ds-reset .ds-highlight {
        color: #0097A7 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
        <div class="ds-thread" 
            data-thread-key="2017/02/05/浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比/" 
            data-url="http://instore.top/2017/02/05/浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比/"
            data-title="浅析数据分布机制：DB2-Oracle-GreenPlum-Teradata横向对比"></div>
    <!-- 多说评论框 end -->
</div>



                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/01/01/机器学习算法笔记-感知机与单层神经网络/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Liang3p's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        liang3p@gmail.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="mailto:liang3p@gmail.com" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2017/02/">二月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">4</span></a>
        </ul>
    </li>

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
             文章总数
             <span class="sidebar-badge">6</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
					<!-- Footer Top Button -->
					<div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
	
	
		<!-- Paradox Footer Left Section -->
		<div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    <a href="https://twitter.com/liang3p" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-twitter.png);">
        <span class="visuallyhidden">Twitter</span>
    </button></a>
    
    
    <!-- Facebook -->
    
    <a href="https://www.facebook.com/profile.php?id=100011242741015" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.png);">
        <span class="visuallyhidden">Facebook</span>
    </button></a>
    
    
    <!-- Google + -->
    
    <a href="https://plus.google.com/115291231508178529929" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
        <span class="visuallyhidden">Google Plus</span>
    </button></a>
    
    
    <!-- Weibo -->
    
    <a href="http://weibo.com/2837545975" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
        <span class="visuallyhidden">Weibo</span>
    </button></a>
    
    
    <!-- Instagram -->
    
    
    
    <!-- Tumblr -->
    
    
    
    <!-- Github -->
    
    
</div>


		<!--Copyright-->
		<div id="copyright">Copyright&nbsp;©&nbsp;<script type="text/javascript">var fd = new Date();document.write(fd.getFullYear());</script>&nbsp;instore.top | Learn More, Share More.</div>

		<!-- Paradox Footer Right Section -->

		<!-- 
		I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
		It will not impact the appearance and can give developers a lot of support :)

		很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
		它不会影响美观并可以给开发者很大的支持。 :) 
		-->

		<div class="mdl-mini-footer--right-section">
			<div>
				<div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
				<div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
			</div>
		</div>
	
    
</footer>
                
				<!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>






    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"instore"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->




<!-- Swiftye -->


<!-- Local Search-->

	<script>
	var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        success: function( xmlResponse ) {
            // get the contents from search data
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length <= 0) {
                    return;
                }
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        str += "<li><a href='"+ data_url +"' class='search-result-title' target='_blank'>"+ data_title;
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out characters
                            var start = first_occur - 6;
                            var end = first_occur + 6;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 10;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substr(start, end); 
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<em class=\"search-keyword\">"+keyword+"</em>");
                            })
                            str += "<p class=\"search-result\">" + match_content +"...</p>" +"</a>";
                        }
                    }
                })
                $resultContent.innerHTML = str;
            })
        }
    })
}
</script>

	<script>
        var inputArea = document.querySelector("#search");
        var getSearchFile = function(){
            var path = "search.xml";
            searchFunc(path, 'search', 'local-search-result');
        }

        inputArea.onfocus = function(){ getSearchFile() }
	</script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $(".post-toc-wrap").parent(".mdl-menu__container").css("position", "fixed");
    });
</script>

<!-- MathJax Load-->

            </main>
        </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
		
    </body>
		
	
</html>
